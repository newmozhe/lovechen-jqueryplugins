!function(a,b,c){var f={yearStep:5,monthDisplay:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],weekDisplay:["日","一","二","三","四","五","六"],weekCss:["lidate_holiday",null,null,null,null,null,"lidate_holiday"],startOfWeek:0,mode:0,showPrevDays:!0,showNextDays:!1,format:"yyyy/MM/dd",flagDays:[],onChoose:null,afterDraw:null},g=function(a,b){this.ele=a,this.opts=c.extend(!0,{},f,b),this.ui={},this.monthDay=[31,0,31,30,31,30,31,31,30,31,30,31],this.year=0,this.month=-1,this._init()},h=function(){c(".lidate_panel").hide(),c("body").off("click",h)};g.prototype={_init:function(){this.initUi();var b=new Date;this.setYear(b.getFullYear()),this.setMonth(b.getMonth()),this.bindEvent()},initUi:function(){var a,b,d;for(this.ui.panel=c("<div class='lidate_panel'></div>"),a="<select class='lidate_monthsel'>",b=0;12>b;++b)a+="<option value='"+b+"'>"+this.opts.monthDisplay[b]+"</option>";for(a+="</select>",this.ui.toolbar=c("<div class='lidate_toolbar'><i class='fa fa-angle-double-left' aria-hidden='true'></i><i class='fa fa-angle-left' aria-hidden='true'></i><span class='lidate_yeardisplay'></span><span class='lidate_monthdisplay'></span><select class='lidate_yearsel'></select>"+a+"<i class='fa fa-angle-right' aria-hidden='true'></i><i class='fa fa-angle-double-right' aria-hidden='true'></i></div>"),d="<ul class='lidate_title'>",b=0;b<this.opts.weekDisplay.length;++b)d+="<li "+(this.opts.weekCss[b]?"class='"+this.opts.weekCss[b]+"'":"")+">"+this.opts.weekDisplay[b]+"</li>";this.ui.title=c(d),this.ui.body=c("<ul class='lidate_body mode"+this.opts.mode+"'></ul>"),this.ui.panel.append(this.ui.toolbar),this.ui.panel.append(this.ui.title),this.ui.panel.append(this.ui.body),c("body").append(this.ui.panel),this.ui.yearDisplay=this.ui.toolbar.find(".lidate_yeardisplay"),this.ui.monthDisplay=this.ui.toolbar.find(".lidate_monthdisplay"),this.ui.yearSelect=this.ui.toolbar.find(".lidate_yearsel"),this.ui.monthSelect=this.ui.toolbar.find(".lidate_monthsel")},setYear:function(a){var b,c,d,e;if(a=parseInt(a),b=a-this.year,c=this.ui.yearSelect.children("option"),1==b)c.eq(0).remove(),this.ui.yearSelect.append("<option value='"+(a+this.opts.yearStep)+"'>"+(a+this.opts.yearStep)+"</option>");else if(-1==b)c.eq(c.length-1).remove(),this.ui.yearSelect.prepend("<option value='"+(a-this.opts.yearStep)+"'>"+(a-this.opts.yearStep)+"</option>");else{for(this.ui.yearSelect.empty(),d="",e=a-this.opts.yearStep;e<=a+this.opts.yearStep;++e)d+="<option value='"+e+"'>"+e+"</option>";this.ui.yearSelect.append(d)}this.ui.yearSelect.val(a),this.ui.yearDisplay.text(a),this.monthDay[1]=0==a%4&&0!=a%100||0==a%400?29:28,this.year=a},setMonth:function(a){a=parseInt(a),0>a?(this.setYear(this.year-1),this.month=11):a>11?(this.setYear(this.year+1),this.month=0):this.month=a,this.ui.monthSelect.val(this.month),this.ui.monthDisplay.text(this.ui.monthSelect.find("option:selected").text()),this.drawCalendar()},drawCalendar:function(){var a,b,c,d,e,f,g,h,i,j;if(this.ui.body.empty(),a=new Date(this.year,this.month,1),b=new Date,c=this.year==b.getFullYear()&&this.month==b.getMonth()?b.getDate():null,a.setDate(1),d=a.getDay(),e=this.opts.startOfWeek<=d?d-this.opts.startOfWeek:7-this.opts.startOfWeek+d,d!=this.opts.startOfWeek)for(f=this.monthDay[0==this.month?11:this.month-1]-d,g=1;e>=g;++g)this.opts.showPrevDays?this.ui.body.append("<li class='lidate_prevdays'>"+(f+g)+"</li>"):this.ui.body.append("<li class='lidate_prevdays'></li>");for(g=1;g<=this.monthDay[this.month];++g)h=" class='lidate_item ",this.opts.weekCss[e]&&(h+=this.opts.weekCss[e]),c&&g==c&&(h+=" lidate_today"),h+="'",this.ui.body.append("<li"+h+">"+g+"</li>"),++e,e>6&&(e=0);if(this.opts.showNextDays&&(a.setDate(this.monthDay[this.month]),i=a.getDay(),6!=i))for(j=6-i,g=1;j>=g;++g)this.ui.body.append("<li class='lidate_nextdays'>"+g+"</li>");this.setFlagDay(),"function"==typeof this.opts.afterDraw&&this.opts.afterDraw(this)},setFlagDay:function(){var a,b,c;if(this.opts.flagDays&&this.opts.flagDays.length>0)for(a=this.ui.body.children(".lidate_item"),b=0,c=this.opts.flagDays.length;c>b;++b)a.eq(this.opts.flagDays[b]-1).addClass("lidate_flagday")},formatDate:function(a,b){var d,c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b},bindEvent:function(){var a=this;this.ui.toolbar.on("click",function(a){a.stopPropagation()}),this.ui.toolbar.on("click",".fa-angle-double-left",function(){a.setYear(a.year-1),a.drawCalendar()}),this.ui.toolbar.on("click",".fa-angle-left",function(){a.setMonth(a.month-1)}),this.ui.toolbar.on("click",".fa-angle-right",function(){a.setMonth(a.month+1)}),this.ui.toolbar.on("click",".fa-angle-double-right",function(){a.setYear(a.year+1),a.drawCalendar()}),this.ui.toolbar.on("change",".lidate_yearsel",function(){a.setYear(c(this).val()),a.drawCalendar()}),this.ui.toolbar.on("change",".lidate_monthsel",function(){a.setMonth(c(this).val())}),this.ele.on("click",function(d){a.ui.panel.is(":hidden")&&(h(),a.ui.panel.css("left",a.ele.offset().left),a.ui.panel.css("top",b.documentElement.clientHeight<a.ele.offset().top+a.ele.outerHeight()+a.ui.panel.outerHeight()?a.ele.offset().top-a.ui.panel.outerHeight():a.ele.offset().top+a.ele.outerHeight()),a.ui.panel.show(),c("body").on("click",h),d.stopPropagation())}),this.ui.body.on("click","li",function(b){var d,e,f;return 1==a.opts.mode&&!c(this).hasClass("lidate_flagday")||2==a.opts.mode&&c(this).hasClass("lidate_flagday")?(b.stopPropagation(),void 0):(d=parseInt(c(this).text()),e=new Date(a.year,a.month,d),f=a.formatDate(e,a.opts.format),("function"!=typeof a.opts.onChoose||a.opts.onChoose(a,e,f))&&(void 0===a.ele.prop("value")?a.ele.text(f):a.ele.val(f)),void 0)})}},c.fn.lidate=function(a){return new g(this,a),this}}(window,document,jQuery);